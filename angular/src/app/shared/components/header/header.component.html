<mat-toolbar class="custom-toolbar" role="heading">
	<a class="h-full logo" [routerLink]="['/']">
		<img class="h-full w-auto" src="./assets/logoFlats4Us.svg" alt="" />
	</a>
	<div
		*appAccessControl="authService.allPermissions.get('allLoggedIn')"
		class="flex items-center max-w-max"
	>
		<ng-container *ngTemplateOutlet="buttons"></ng-container>
	</div>
	<div class="spacer"></div>
	<div *ngIf="authService.isLoggedIn$ | async; else notLoggedIn">
		<button
			*ngIf="user$ | async as user"
			class="your-profile"
			[matMenuTriggerFor]="myProfile"
			(click)="showSidenav ? (showSidenav = false) : showSidenav"
		>
			<img
				class="your-photo"
				alt="Twój profil"
				[src]="user.profilePicture?.path ? baseUrl + '/' + user.profilePicture?.path : './assets/avatar.png'"
			/>
		</button>
	</div>
	<mat-menu #myProfile="matMenu">
		<button mat-menu-item [routerLink]="['profile', 'details', 'my']">
			<mat-icon class="material-symbols-outlined">person</mat-icon>
			Mój profil
		</button>
		<button mat-menu-item [routerLink]="['profile', 'edit']">
			<mat-icon class="material-symbols-outlined">edit</mat-icon>
			Edytuj profil
		</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedOwner')"
			mat-menu-item
			[routerLink]="['rents', 'owner']"
		>
		<mat-icon class="material-symbols-outlined">handshake</mat-icon>
			Moje wynajmy
		</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedStudent')"
			mat-menu-item
			[routerLink]="['rents', 'student']"
		>
		<mat-icon class="material-symbols-outlined">handshake</mat-icon>
			Moje wynajmy
		</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedOwner')"
			mat-menu-item
			[routerLink]="['offer', 'owner']"
		>
		<mat-icon class="material-symbols-outlined">campaign</mat-icon>
			Moje oferty
		</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedOwner')"
			mat-menu-item
			[routerLink]="['real-estate', 'owner']"
		>
		<mat-icon class="material-symbols-outlined">real_estate_agent</mat-icon>
			Moje nieruchomości
		</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedOwner')"
			mat-menu-item
			[routerLink]="['real-estate', 'add']"
		>
		<mat-icon class="material-symbols-outlined">apartment</mat-icon>
			Dodaj nieruchomość
		</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedOwner')"
			mat-menu-item
			[routerLink]="['offer', 'add']"
		>
		<mat-icon class="material-symbols-outlined">home_pin</mat-icon>
			Dodaj ofertę
		</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedStudent')"
			mat-menu-item
			[routerLink]="['offer', 'watched']"
		>
		<mat-icon class="material-symbols-outlined">favorite</mat-icon>
			Obserwowane oferty
		</button>
		<button mat-menu-item (click)="authService.logout()">
		<mat-icon class="material-symbols-outlined">logout</mat-icon>
			Wyloguj się</button>
	</mat-menu>

	<ng-template #notLoggedIn>
		<div class="start-navbar-button spacer">
			<button
				class="button-log"
				mat-stroked-button
				[routerLink]="['auth', 'login']"
			>
			<mat-icon class="material-symbols-outlined">login</mat-icon>
				Logowanie
			</button>
			<button
				class="button-sign"
				mat-stroked-button
				[routerLink]="['profile', 'create']"
			>
			<mat-icon class="material-symbols-outlined">passkey</mat-icon>
				Rejestracja
			</button>
		</div>
	</ng-template>
	<button
		mat-icon-button
		class="responsive-menu"
		(click)="showSidenav = !showSidenav"
	>
		<mat-icon class="material-icons-outlined">menu</mat-icon>
	</button>
</mat-toolbar>
<div
	*ngIf="showSidenav"
	class="sidenav flex flex-col w-[180px] min-h-max bg-white"
>
	<ng-container *ngTemplateOutlet="buttons"></ng-container>
</div>

<ng-template #buttons>
	<button mat-button class="mr-2" [routerLink]="['/']">
		<mat-icon class="material-symbols-outlined">home</mat-icon>
		Strona główna
	</button>
	<button
		*appAccessControl="authService.allPermissions.get('notLoggedIn')"
		class="mr-2"
		mat-button
		[routerLink]="['auth', 'login']"
	>
		<mat-icon class="material-symbols-outlined">login</mat-icon>
		Logowanie
	</button>
	<button
		*appAccessControl="authService.allPermissions.get('notLoggedIn')"
		class="mr-2"
		mat-button
		[routerLink]="['profile', 'create']"
	>
		<mat-icon class="material-symbols-outlined">app_registration</mat-icon>
		Rejestracja
	</button>
	<button
		*appAccessControl="authService.allPermissions.get('allLoggedIn')"
		mat-button
		class="mr-2"
		[routerLink]="['messages']"
	>
		<mat-icon class="material-icons-outlined">chat</mat-icon>
		Wiadomości
	</button>
	<button
		*appAccessControl="authService.allPermissions.get('allLoggedIn')"
		mat-button
		class="mr-2"
		[routerLink]="['settings']"
	>
		<mat-icon class="material-icons-outlined">settings</mat-icon>
		Ustawienia
	</button>

	<button
		*appAccessControl="authService.allPermissions.get('allLoggedIn')"
		mat-button
		class="mr-2"
		[matMenuTriggerFor]="extended"
	>
		<mat-icon class="material-icons-outlined">arrow_drop_down</mat-icon>
		Dodatkowe
	</button>

	<mat-menu #extended="matMenu">
		<button mat-menu-item [routerLink]="['calendar']">
		<mat-icon class="material-symbols-outlined">calendar_month</mat-icon>
			Kalendarz</button>
		<button
			*appAccessControl="authService.allPermissions.get('verifiedStudent')"
			mat-menu-item
			routerLink="find-roommate"
		>
			Znajdź wspołlokatora
		</button>
	</mat-menu>
</ng-template>
